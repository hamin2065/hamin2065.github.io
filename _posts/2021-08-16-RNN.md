---
layout: post
title:  RNN
subtitle:   
categories:  ai
tags: season-2
---

# RNN
값뿐만 아니라 순서도 중요한 데이터(Sequential Data)를 다루기 위해 쓰인다.

ex) Hello라는 단어를 보면

h -> e -> l -> l -> o : 이 순서가 단어를 형성하는데 아주 중요하다

![](https://img1.daumcdn.net/thumb/R720x0.q80/?scode=mtistory2&fname=http%3A%2F%2Fcfile23.uf.tistory.com%2Fimage%2F2578204757AC186F2A70DC)

위 그림과 같이 $$x_t$$ 에서 A라는 `셀(cell)`로 들어가서 $$h_t$$ 라는 출력값이 나오는 동시에 다시 A로 들어가는 값이 있다. 이 값을 `hidden state`라고 하는데 RNN구조를 밖에서 보면 출력되는 값이 아니기 때문에 보이지 않는다. 이 RNN 구조를 쭉 펼쳐보면 ht의 값은 그 전단계의 입력의 처리값을 반영하기 때문에 그 순서를 이해할 수 있는 것이다.

> __셀(cell)__ : RNN에서 은닉층에서 활성화 함수를 통해 결과를 내보내는 역할을 하는 노드
>
> 이전의 값을 기억하려고 하는 일종의 메모리 역할을 수행하므로 이를 메모리 셀 또는 RNN 셀이라고 표현
>
> __은닉상태(hidden state)__ : 메모리셀이 출력층 방향으로 또는 다음 시점 t+1의 자신에게 보내는 값을 말함
>
> t 시점의 메모리셀은 t-1시점의 메모리 셀이 보낸 은닉 상태값을 t시점의 은닉 상태 계산을 위한 입력값으로 사용
>

위에서 예시로 들었던 `hello`를 다시보면 $$x_0$$ 에 h가 들어가면 그 다음값인 e가 $$h_0$$ (결과값)으로 나오고 입력값인 $$x_1$$ 으로 e가 들어가고 $$x_1$$ 으로 l이 나오는 형식이 반복되는 것이다.

같은 l에 대해서 어떤 경우에는 l을 출력하고 어떤 경우에는 o를 출력해야하는 어려움이 있다. 이럴 때 이용하는 것이 hidden state인데 어떤 문자가 나왔다는 사실을 hidden state를 통해서 전달해준다.

RNN은 모든 셀이 파라미터를 공유한다. A가 하나라는 뜻이다. 아무리긴 문자열이 들어와도 A하나로 처리가 가능하다.

- - -

그렇다면 A에서는 어떤식으로 동작할까?
어떻게 설계하느냐에 따라서 굉장히 달라지지만 일반적으로 

$$h_t = f(h_{t-1},x_t)$$ 
의 방식을 따른다. 
A에서는 함수 연산이 일어나는데, 전 단계의 hidden state와 이번 단계의 입력값으로 함수 연산을 하는 것이다.

예시로,
$$h_t = tanh({W_h}{h_{t-1}}+{W_t}{x_t})$$
전 단계의 hidden state에 $$W_h$$ 라는 행렬을 곱하고 이번 단계의 입력값에도 $${W_t}$$ 의 행렬을 곱하는 방식이 있다.

- - -

# Usages of RNN
![](http://www.popit.kr/wp-content/uploads/2016/12/rnn_model-1024x321.jpeg)

- `one to one` : RNN이 아닌 일반적인 Neural Network의 방식이라고 말할 수 있다.
- `one to many` : 하나의 입력값에서 출력값이 여러개이다. 하나의 이미지가 들어가서 여러개의 시퀀스(문장)가 나오는 것이다. 예를 들면 하나의 이미지에 대해서 무엇을 하고있는지에 대한 자막이 달리는 것이다.
- `many to one` : 여러개의 단어, 즉 문장이 입력이 된다. 하나의 결과값의 예시로 감정에 대한 레이블을 얘기할 수 있다. 하나의 문장에 대해서 이 문장이 어떠한 감정의 레이블을 가지고 있는지 결과로 출력하는 것이다.(Sentiment Analysis)
- `many to many` : 하나의 문장이 들어오고 출력값으로도 문장이 나간다. 오른쪽 `many to many`와 비교해보면 출력되는 지점이 조금 다른 것을 볼 수 있다. 출력값쪽에 비워져있는 부분도 출력값이 없는게 아니라 출력값이 있지만 쓰지 않는 것이다. 하나의 문장에 대해서 입력이 전부 끝나면 그 이후에 문장이 출력되는 것인데 번역할 때 이러한 방식이 쓰인다.
- `many to many` : 여러개의 입력이 있고 그 입력마다 출력이 나오는 형태가 있다. 이러한 방식은 문장보다는 비디오에 적용이 된다. 비디오는 이미지의 집합체인데 이전 이미지에는 없었던 부분이 다음 이미지에는 출력될 때 어떠한 변화가 있었는지 인식을 하고 분석 결과를 내놓을 수 있다.